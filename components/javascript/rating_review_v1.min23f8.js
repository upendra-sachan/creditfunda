!function(e){var r="input[name=customer_review_type]:checked",t=/^[a-zA-Z ]*$/,a="",s="",o="",c=0;function _(r){"2"===r?(e("#bank_option").hide(),e("#paisa_product_list").hide()):"0"===r?(e("#paisa_product_list").show(),e("#bank_option").hide()):(e("#paisa_product_list").hide(),e("#bank_option").show())}function n(r,t){t=void 0!==t?t:0,e.ajax({url:"/customer-review/",type:"POST",data:"step="+r+"&bank_id="+t,dataType:"json",success:function(r){r&&function(r,t,i){var a="<option value=''>"+t+"</option>";for(var s in r)r.hasOwnProperty(s)&&(a+="<option value="+r[s]+" >"+s+"</option>");e("#"+i).html(a).selectpicker("refresh")}(r,"Select City","customer_review_city_id")}})}function u(){showLoader("loading","display-block"),e("#overlay_show ").css("display","block")}function v(){showLoader("loading","display-none"),e("#overlay_show ").css("display","none")}function d(){if("/customer-review/"==e("#customer_review").attr("action")){var r=e("#customer_review_comment").val().length;if(r>500)return e("#char_length").text("You have reached the limit."),e("#char_length").css("color","red"),!1;var t=500-r;return e("#char_length").text(t+" characters left (50 to 500 characters)"),e("#char_length").css("color","#666"),0!=r&&r<=50?(e("#customer_review_comment").addClass("btn-error"),!1):(r>=50||""===e("#customer_review_comment").val()||""===e("#customer_review_title").val())&&(e("#customer_review_title").removeClass("btn-error"),e("#customer_review_comment").removeClass("btn-error"),!0)}}function l(r){var t="<option value=''>Select Bank</option>";""===r&&e("#customer_review_bank_id").html(t).selectpicker("refresh"),e.ajax({url:"/customer-review/",type:"GET",data:"step=bank_product&product_of_bank="+r,dataType:"json",success:function(r){if("success"==r.statusCode){var a=r.response;for(i=0;i<a.length;i++)t+="<option value="+a[i].bank_id+"  "+a[i].bank_slug+"='"+a[i].bank_id+"' >"+a[i].bank_name+"</option>";if(e("#customer_review_bank_id").html(t).selectpicker("refresh"),""!==bankSlug&&""!==product){var s=e("#customer_review_bank_id option").map(function(){return e(this).attr(bankSlug)});bankID=s[0],"customer-review"===page_action_url?(e("#customer_review_bank_id").val(bankID),e("#product_of_bank").val(product),e("#customer_review_bank_id, #product_of_bank").selectpicker("refresh"),n("bank_city"),bankSlug="",product="",productId=""):m(0)}}}})}function m(t){var d=e("#customer_review_paisa_product_id").val(),l=e("#customer_review_city_id").val(),m=void 0!==t?t:0,p=e("#product_review_filter").attr("action");""!==bankSlug&&""!==product?(a=1,s=product,o=bankID,_(1),e("#paisabazaar_bank").prop("checked",!0),e("#product_of_bank").val(s),e("#product_of_bank").selectpicker("refresh"),n("bank_city")):""!==productId?(d=productId,a="0"):(a=e(r).val(),s=e("#product_of_bank").val(),o=e("#customer_review_bank_id").val());var w={customer_review_type:a,product_of_bank:s,customer_review_bank_id:o,customer_review_city_id:l,customer_review_paisa_product_id:d};if(null==w.customer_review_bank_id&&(w.customer_review_bank_id=""),"/reviews/"==p){var b="customer_review_type="+w.customer_review_type+"&product_of_bank="+w.product_of_bank+"&customer_review_bank_id="+w.customer_review_bank_id+"&customer_review_city_id="+w.customer_review_city_id+"&customer_review_paisa_product_id="+w.customer_review_paisa_product_id+"&step=filter_product&page="+m;u(),e.ajax({url:"customer-review/",type:"POST",data:b,dataType:"json",success:function(t){if(e(".success_message").css("display","block"),v(),!0===t.success){!function(r){var t="",a=r.items;for(i=0;i<a.length;i++){var s="",o=a[i].review_comment,c=o.replace("\\",""),_=a[i].review_product_name;if("Bureau Report"==_&&(_="Credit Report"),t+='<div class="col-lg-3 col-md-4 col-sm-6 col-xs-12">\n                            <div class="review-box">\n                                <div class="review-info">\n                                    <div class="bank-title-box">\n                                        <span>'+_+'</span>\n                                    </div>\n                                    <div class="review-rating">\n                                            <div class="set_review_'+i+' customer_reviews side-rating"></div>\n                                    </div>\n                                    <p><strong>'+a[i].review_title.replace("\\","")+"</strong></p>",c.length>300){var n=c.substr(0,300)+"...";s='<a id="_'+i+'" class="read-more-btn read_more pull-right" href="javascript:void(0);">Read more...</a>',t+='<div class="" id="hidden_'+i+'"><p>'+n+s+"</p></div>"}else t+='<div class=""><p>'+c+"</p></div>";t+='<div id="show_'+i+'" class="hidden"><div id="scrollbar-event_'+i+'" class="scrollbar-dynamic"><p>'+c+"</p></div></div>",t+='</div><div class="short-profile">\n                                    <img src="/components/images/rating_review/male-profile.jpg" class="male-profile-pic" alt="Male Profile Pic"/>\n                                    <span><strong>'+a[i].review_user_name+"</strong><br>Posted on:  "+a[i].review_date+"</span>\n                                </div>\n                            </div>\n                        </div>"}r.total_limit>r.set_limit&&(t+='<div class="col-md-12">'+r.pagination+"</div>");e("#get_filter_data").html(t)}(t);var a=t.items;for(i=0;i<a.length;i++)s=i,_=a[i].review_value,e(".set_review_"+s).starrr({rating:_,readOnly:!0})}else e("#get_filter_data").html(function(){if("1"===e(r).val()){var t=e("#product_of_bank").val(),i=e("#customer_review_bank_id option:selected").attr("bank-name");""!==i&&void 0!==i&&""!==t&&void 0!==t&&i+"/"+t+"/"}else"0"===e(r).val()&&e("#customer_review_paisa_product_id").val()+"/";return'<div class="col-md-12 text-center review_not_found" style="margin-bottom:10px"><div class="col-md-12">Be the first to review!</div><div class="col-md-12"><a href="/customer-review/'+""+'" class="review-btn"><i class="fa fa-pencil"> </i> &nbspWrite a review</a></div></div>'}());var s,_;1==c&&e("#customer_review_bank_id").val("0"),""!==bankSlug&&""!==product?(e("#customer_review_bank_id").val(o),e("#customer_review_bank_id").selectpicker("refresh")):""!=productId&&(e("#customer_review_paisa_product_id").val(productId),e("#customer_review_paisa_product_id").selectpicker("refresh")),e("#customer_review_bank_id").val("0"),bankSlug="",product="",productId=""}})}return!1}e(document).ready(function(){e("#stars").starrr({change:function(r,t){0==t?e(".customer_review_value").addClass("customer_review_value_error"):e(".customer_review_value").removeClass("customer_review_value_error"),e(".customer_review_value").attr("rating",t)}}),e(".selectpicker").val("").selectpicker("refresh"),""!==bankSlug&&""!==product?(l(product),_("1")):""!==productId?(e("#paisabazaar").prop("checked",!0),_("0"),"customer-review"===page_action_url?(e("#customer_review_paisa_product_id").val(productId),e("#customer_review_paisa_product_id").selectpicker("refresh"),productId=""):m("0")):(_(e(r).val()),m("0")),n("bank_city")}),e("input[name=customer_review_type]:radio").change(function(r){_(e(r.currentTarget).val())}),e(document).ready(function(){e("#customer_review").submit(function(i){var a="",s=function(){var i=!0,a=e(r).val(),s=e(".bank-select option:selected").val(),o=e("#customer_review_bank_id option:selected").val(),c=e("#product_of_bank option:selected").val(),_=(e("#customer_review_city_id option:selected").val(),e(".customer_review_value").attr("rating")),n=e("#customer_review_user_name").val(),u=e("#customer_review_title").val(),v=e("#customer_review_comment").val(),l=d();"0"===a?""===s&&(e("#customer_review_paisa_product_id").selectpicker("setStyle","btn-error","add"),i=!1):(""===o&&(e("#customer_review_bank_id").selectpicker("setStyle","btn-error","add"),i=!1),""===c&&(e("#product_of_bank").selectpicker("setStyle","btn-error","add"),i=!1));"0"===_&&(e(".customer_review_value").addClass("customer_review_value_error"),i=!1);""==n.trim()&&(e("#customer_review_user_name").addClass("btn-error"),i=!1);if(""!=n.trim()){var m=e("#customer_review_user_name").val()==e("#customer_review_user_name").val().match(t);!1===m&&(e("#customer_review_user_name").addClass("btn-error"),i=!1)}""===u.trim()&&e("#customer_review_title").removeClass("btn-error");""===v.trim()&&e("#customer_review_comment").removeClass("btn-error");""===u.trim()&&""!==v.trim()&&(!1===l&&(e("#customer_review_comment").addClass("btn-error"),i=!1),e("#customer_review_title").addClass("btn-error"),i=!1);""!==u.trim()&&""==v.trim()&&(!1===l&&(i=!1),e("#customer_review_comment").addClass("btn-error"),i=!1);if(""!==u.trim()&&""!=v.trim()){var l=d();!1===l&&(i=!1)}if(!1===i)return!1;return i}(),o=e(r).val(),c="";if(!0===s){if("1"===o){var _=e("#product_of_bank option:selected").text();a=e("#customer_review_bank_id option:selected").text()+" "+_}else{a=e("#customer_review_paisa_product_id option:selected").text()}var n=e("#customer_review_paisa_product_id option:selected").attr("product");"1"===e(r).val()&&(n=e("#product_of_bank").val()),u();var l={customer_review_type:e(r).val(),product_slug:n,customer_review_bank_id:e("#customer_review_bank_id").val(),customer_review_city_id:e("#customer_review_city_id").val(),customer_review_paisa_product_id:e("#customer_review_paisa_product_id").val(),customer_review_user_name:e("#customer_review_user_name").val(),customer_review_title:e("#customer_review_title").val(),customer_review_comment:e("textarea#customer_review_comment").val(),customer_review_value:e(".customer_review_value").attr("rating"),product_title:a,step:"set_paisa_product"};""!=l.customer_review_city_id&&null!=l.customer_review_city_id||(l.customer_review_city_id=""),e.ajax({url:/customer-review/,data:l,type:"POST",dataType:"json",success:function(r){var t=r;if(v(),e(".customer_review_value").attr("rating",0),e(".customer_review_value").find("*").each(function(){e(this).removeClass("my_rating"),e(this).addClass("star-empty")}),!0===t.status||"success"===t.statusCode){e("#customer_review").find("input[type=text], textarea").val("");e("#customer_review_bank_id").html("<option value=''>Select Bank</option>").selectpicker("refresh"),e(".selectpicker").val("").selectpicker("refresh"),e("#stars").attr("rating",0),c="<h3>Your Review Submitted Successfully.</h3>"}else c="<h3>There is an error. Please try again later.</h3>";e(".success_message").html(c),setTimeout(function(){e(".success_message").html("")},8e3)}})}return!1})}),e(".selectpicker").on("change",function(r,t){var i=e(r.currentTarget);""!=i.val()&&e("#"+i.attr("id")).selectpicker("setStyle","btn-error","remove")}),e("input, textarea").on("change blur keyup",function(r){var i=e(r.currentTarget),a=i.attr("id");"customer_review_user_name"==i.attr("id")?1==(e("#"+a).val()==e("#"+a).val().match(t))&&e("#"+a).removeClass("btn-error"):""!=i.val()&&e("#"+a).removeClass("btn-error");d()}),e("#customer_review_comment").on("keyup",function(){d()}),e("input, select").on("change",function(r){var t=e("form").attr("action");"/reviews/"==t?("paisabazaar"!=r.target.id&&"paisabazaar_bank"!=r.target.id&&"paisa_brand"!=r.target.id||e(".selectpicker").val("").selectpicker("refresh"),"product_of_bank"===r.target.id&&(l(r.target.value),c=1),m(0)):"/customer-review/"===t&&"product_of_bank"===r.target.id&&(l(r.target.value),c=0)}),jQuery(".reviews").delegate(".read-more-btn","click",function(e){var r=e.currentTarget,t=jQuery(r).attr("id");jQuery("#hidden"+t).addClass("hidden"),jQuery("#scrollbar-event"+t).scrollbar(),jQuery("#scrollbar-event"+t).css("padding-right","10px"),jQuery("#show"+t).removeClass("hidden"),jQuery("#show"+t).css("display","block"),jQuery("#"+t).html("")}),e(document).delegate(".page_active","click",function(r){var t=r.currentTarget;m(e(t).attr("p"))}),e(document).on("keypress","#customer_review_user_name, #customer_review_title",function(r){return formatValidatorNew(r,e(this),"","","",2,"","","","","")}),e(document).on("paste","#customer_review_user_name, #customer_review_title",function(r){var t=e(r.currentTarget).attr("id");setTimeout(function(){var r=e("#"+t).val().replace(/[^\w\s]/gi,"");e("#"+t).val(r)})})}(jQuery);